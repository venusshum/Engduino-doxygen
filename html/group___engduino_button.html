<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Engduino: Driver for Engduino Button</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Engduino.ico"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Engduino
   &#160;<span id="projectnumber">3.1.0</span>
   </div>
   <div id="projectbrief">A fun device for learning coding</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Driver for Engduino Button</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:_engduino_button_8cpp"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_engduino_button_8cpp.html">EngduinoButton.cpp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:_engduino_button_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_engduino_button_8h.html">EngduinoButton.h</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_engduino_button_class.html">EngduinoButtonClass</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gadb75862f582a7d68347ceae4f4c003c9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gadb75862f582a7d68347ceae4f4c003c9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEBOUNCE_DELAY</b>&#160;&#160;&#160;50</td></tr>
<tr class="separator:gadb75862f582a7d68347ceae4f4c003c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga28be307ba14efb36d0965f4be9c19b62"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engduino_button.html#ga28be307ba14efb36d0965f4be9c19b62">ISR</a> (INT6_vect)</td></tr>
<tr class="memdesc:ga28be307ba14efb36d0965f4be9c19b62"><td class="mdescLeft">&#160;</td><td class="mdescRight">ISR for INT.6 on the ATMega32U4. This is connected to the button.  <a href="#ga28be307ba14efb36d0965f4be9c19b62">More...</a><br /></td></tr>
<tr class="separator:ga28be307ba14efb36d0965f4be9c19b62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6259e9cde08e3b67bf7cb921c4dd8458"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga6259e9cde08e3b67bf7cb921c4dd8458"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>INT6_vect</b> (void) __attribute__((signal))</td></tr>
<tr class="separator:ga6259e9cde08e3b67bf7cb921c4dd8458"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga63fbf8689adcf68e546153e1cba62277"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engduino_button.html#ga63fbf8689adcf68e546153e1cba62277">EngduinoButtonClass::EngduinoButtonClass</a> ()</td></tr>
<tr class="memdesc:ga63fbf8689adcf68e546153e1cba62277"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ga63fbf8689adcf68e546153e1cba62277">More...</a><br /></td></tr>
<tr class="separator:ga63fbf8689adcf68e546153e1cba62277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22235e73e3a5e2e4b0a8c12709b53ea5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engduino_button.html#ga22235e73e3a5e2e4b0a8c12709b53ea5">EngduinoButtonClass::begin</a> (long debounceDelay=DEBOUNCE_DELAY)</td></tr>
<tr class="memdesc:ga22235e73e3a5e2e4b0a8c12709b53ea5"><td class="mdescLeft">&#160;</td><td class="mdescRight">begin function - must be called before using other functions  <a href="#ga22235e73e3a5e2e4b0a8c12709b53ea5">More...</a><br /></td></tr>
<tr class="separator:ga22235e73e3a5e2e4b0a8c12709b53ea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabd1ddb88707b93a8ebd1ad61c458073e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engduino_button.html#gabd1ddb88707b93a8ebd1ad61c458073e">EngduinoButtonClass::end</a> ()</td></tr>
<tr class="memdesc:gabd1ddb88707b93a8ebd1ad61c458073e"><td class="mdescLeft">&#160;</td><td class="mdescRight">end function - switch off the button  <a href="#gabd1ddb88707b93a8ebd1ad61c458073e">More...</a><br /></td></tr>
<tr class="separator:gabd1ddb88707b93a8ebd1ad61c458073e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b1d7a4d6a9602d549ad7d22fbe1d61b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engduino_button.html#ga7b1d7a4d6a9602d549ad7d22fbe1d61b">EngduinoButtonClass::isPressed</a> ()</td></tr>
<tr class="memdesc:ga7b1d7a4d6a9602d549ad7d22fbe1d61b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check to see if the button is pressed.  <a href="#ga7b1d7a4d6a9602d549ad7d22fbe1d61b">More...</a><br /></td></tr>
<tr class="separator:ga7b1d7a4d6a9602d549ad7d22fbe1d61b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab7c5e25ca8c7b46bb5afb89349dc2764"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engduino_button.html#gab7c5e25ca8c7b46bb5afb89349dc2764">EngduinoButtonClass::waitUntilPressed</a> ()</td></tr>
<tr class="memdesc:gab7c5e25ca8c7b46bb5afb89349dc2764"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait until the button is pressed. Blocking call.  <a href="#gab7c5e25ca8c7b46bb5afb89349dc2764">More...</a><br /></td></tr>
<tr class="separator:gab7c5e25ca8c7b46bb5afb89349dc2764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6c073bb47b4514b4489092ff1d8d4191"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engduino_button.html#ga6c073bb47b4514b4489092ff1d8d4191">EngduinoButtonClass::waitUntilReleased</a> ()</td></tr>
<tr class="memdesc:ga6c073bb47b4514b4489092ff1d8d4191"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait until the button is released. Blocking call.  <a href="#ga6c073bb47b4514b4489092ff1d8d4191">More...</a><br /></td></tr>
<tr class="separator:ga6c073bb47b4514b4489092ff1d8d4191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7265d49dd122b3a0bf39b01f4219291"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engduino_button.html#gaa7265d49dd122b3a0bf39b01f4219291">EngduinoButtonClass::wasPressed</a> ()</td></tr>
<tr class="memdesc:gaa7265d49dd122b3a0bf39b01f4219291"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check to see if the button was pressed since our last check.  <a href="#gaa7265d49dd122b3a0bf39b01f4219291">More...</a><br /></td></tr>
<tr class="separator:gaa7265d49dd122b3a0bf39b01f4219291"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad1df7a49cef083fb338415d172232f92"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engduino_button.html#gad1df7a49cef083fb338415d172232f92">EngduinoButtonClass::wasReleased</a> ()</td></tr>
<tr class="memdesc:gad1df7a49cef083fb338415d172232f92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check to see if the button was released since our last check.  <a href="#gad1df7a49cef083fb338415d172232f92">More...</a><br /></td></tr>
<tr class="separator:gad1df7a49cef083fb338415d172232f92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7725cc88999b6287c4b2e3ba0d2f4cac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___engduino_button.html#ga7725cc88999b6287c4b2e3ba0d2f4cac">EngduinoButtonClass::reset</a> ()</td></tr>
<tr class="memdesc:ga7725cc88999b6287c4b2e3ba0d2f4cac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the wasPressed/wasReleased state.  <a href="#ga7725cc88999b6287c4b2e3ba0d2f4cac">More...</a><br /></td></tr>
<tr class="separator:ga7725cc88999b6287c4b2e3ba0d2f4cac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gafa9c41eb26e1fbf281f34e6c8870aedc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gafa9c41eb26e1fbf281f34e6c8870aedc"></a>
<a class="el" href="class_engduino_button_class.html">EngduinoButtonClass</a>&#160;</td><td class="memItemRight" valign="bottom"><b>EngduinoButton</b> = <a class="el" href="class_engduino_button_class.html">EngduinoButtonClass</a>()</td></tr>
<tr class="separator:gafa9c41eb26e1fbf281f34e6c8870aedc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa9c41eb26e1fbf281f34e6c8870aedc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gafa9c41eb26e1fbf281f34e6c8870aedc"></a>
<a class="el" href="class_engduino_button_class.html">EngduinoButtonClass</a>&#160;</td><td class="memItemRight" valign="bottom"><b>EngduinoButton</b></td></tr>
<tr class="separator:gafa9c41eb26e1fbf281f34e6c8870aedc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This is the driver code for the button on the Engduino. This uses an ISR to debounce the button - it uses edges rather than the value of the digital pin.</p>
<p>The debounce time can be set in the begin routine, but defaults to the DEBOUNCE_DELAY value defined in the header. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga22235e73e3a5e2e4b0a8c12709b53ea5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EngduinoButtonClass::begin </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>debounceDelay</em> = <code>DEBOUNCE_DELAY</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>begin function - must be called before using other functions </p>
<p>This function enables the button. It can be called with a parameter that represents the debounce delay, but this defaults to a sensible value if it is not provided. </p>

</div>
</div>
<a class="anchor" id="gabd1ddb88707b93a8ebd1ad61c458073e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EngduinoButtonClass::end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>end function - switch off the button </p>
<p>Switch off the interrupt and reset state. </p>

</div>
</div>
<a class="anchor" id="ga63fbf8689adcf68e546153e1cba62277"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EngduinoButtonClass::EngduinoButtonClass </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>C++ constructor for this class. Empty. </p>

</div>
</div>
<a class="anchor" id="ga7b1d7a4d6a9602d549ad7d22fbe1d61b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EngduinoButtonClass::isPressed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check to see if the button is pressed. </p>
<p>Check to see if the button is pressed. If it is not pressed, it is, by definition, released. </p>

</div>
</div>
<a class="anchor" id="ga28be307ba14efb36d0965f4be9c19b62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">INT6_vect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ISR for INT.6 on the ATMega32U4. This is connected to the button. </p>
<p>This ISR is set to go off on either edge, but we change which edge depending on whether we last saw a falling edge or a rising edge. This seems overkill, but trying to implement this ISR to react to a change of any description doesn't work well, because we can't tell which direction the change is in. Given we have an edge, set the state of the button and whether it was pressed or released, but only if the switch isn't bouncing. We determine whether it is bouncing by looking at how long it's been stable for; if this is long enough, then we regard this as being the first edge (button not bouncing) and change state. If it is not, we simply record the current time as the time of the last change. </p>

</div>
</div>
<a class="anchor" id="ga7725cc88999b6287c4b2e3ba0d2f4cac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EngduinoButtonClass::reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the wasPressed/wasReleased state. </p>
<p>This function resets the wasPressed/wasReleased state to false - it can be used to start a period of looking for a button press, ignoring what happened before reset was called. Note, however, that calling wasPressed or wasReleased also resets the appropriate part of the state. </p>

</div>
</div>
<a class="anchor" id="gab7c5e25ca8c7b46bb5afb89349dc2764"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EngduinoButtonClass::waitUntilPressed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait until the button is pressed. Blocking call. </p>
<p>Just loops indefinitely, polling the button state until the button is pressed. The event we wait for is the button going down. If the button is currently pressed, we wait for it to be released and then wait for it to be pressed again </p>

</div>
</div>
<a class="anchor" id="ga6c073bb47b4514b4489092ff1d8d4191"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EngduinoButtonClass::waitUntilReleased </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait until the button is released. Blocking call. </p>
<p>Just loops indefinitely, polling the button state until the button is released. The event we wait for is the button going up. If the button is currently released, we wait for it to be pressed and then wait for it to be released again </p>

</div>
</div>
<a class="anchor" id="gaa7265d49dd122b3a0bf39b01f4219291"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EngduinoButtonClass::wasPressed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check to see if the button was pressed since our last check. </p>
<dl class="section return"><dt>Returns</dt><dd>Whether or not is has been pressed since we last checked.</dd></dl>
<p>This function checks to see if the button has been pressed in some intervening period when we were not checking it actively. On each check we return a boolean that shows whether the button has been pressed, and we reset the state so one can look for a new button press at some later point. </p>

</div>
</div>
<a class="anchor" id="gad1df7a49cef083fb338415d172232f92"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EngduinoButtonClass::wasReleased </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check to see if the button was released since our last check. </p>
<dl class="section return"><dt>Returns</dt><dd>Whether or not is has been released since we last checked.</dd></dl>
<p>This function checks to see if the button has been released in some intervening period when we were not checking it actively. On each check we return a boolean that shows whether the button has been released, and we reset the state so one can look for a new button release at some later point. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Feb 11 2015 23:31:16 for Engduino by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
